pico-8 cartridge // http://www.pico-8.com
version 42
__lua__
--lander test
--m ivkovic (whippet)

function _init()
	game_over=false
	win=false
	g=0.035 --gravity
	make_starfield(50) --no of stars
	make_player()
	make_ground()
end

function _update()
	if (not game_over) then
		move_player()
		check_land()
	else
		if (btnp(❎)) _init()
	end
end

function _draw()
	cls()
	draw_stars()
	draw_ground()
	draw_player()
	
	if (game_over) then
		if (win) then
			print("you win!",48,48,11)
		else
			print("oooh, that's gotta hurt!",18,48,8)
		end
		print("press ❎ to play again",20,70,5)
	end
end
-->8
--player

function make_player()
	p={}
	p.x=60
	p.y=8
	p.dx=0
	p.dy=0
	p.sprite=1
	p.alive=true
	p.thrust=0.07
end

function move_player()
	p.dy+=g --add grav
	
	thrust()
	
	p.x+=p.dx
	p.y+=p.dy
	
	stay_on_screen()
end

function stay_on_screen()
	if (p.x<0) then
		p.x=0
		p.dx=0
	end
	if (p.x>119) then
		p.x=119
		p.dx=0
	end
	if (p.y<0) then
		p.y=0
		p.dy=0
	end
end

function thrust()
	if (btn(⬅️)) p.dx-=p.thrust
	if (btn(➡️)) p.dx+=p.thrust
	if (btn(⬆️)) p.dy-=p.thrust
	
	if (btn(⬅️) or btn(➡️) or btn(⬆️)) then
		sfx(0)
		p.sprite=2
	else
		p.sprite=1
	end
end

function draw_player()
	spr(p.sprite,p.x,p.y)
	if (game_over and win) then
		spr(3,p.x,p.y)
	elseif (game_over) then
		spr(4,p.x,p.y)
	end
end

function check_land()
	--ship sprite edges l,r,b
	l_x=flr(p.x)
	r_x=flr(p.x+7)
	b_y=flr(p.y+7)
	
	over_pad=l_x>=pad.x and r_x<=pad.x+pad.width
	on_pad=b_y>=pad.y-1
	slow=p.dy<1
	
	if (over_pad and on_pad and slow) then
		end_game(true)
	elseif (over_pad and on_pad) then
		end_game(false)
	else
		for i=l_x,r_x do
			if (gnd[i]<=b_y) end_game(false)
		end
	end	
end

function end_game(won)
	game_over=true
	win=won
	
	if (win) then
		sfx(1)
	else
		sfx(3)
	end
end
-->8
--environment

function rnde(low,high)
	return flr(rnd(high-low+1)+low)
end

function make_starfield(density)
	stars={}
	for i=1,density do
		local s={}
		s.x=rnde(1,127)
		s.y=rnde(1,127)
		s.color=rnde(5,7)
		
		add(stars,s)
	end
end

function draw_stars()	
	for s in all(stars) do
		pset(s.x,s.y,s.color)
	end
end

function make_ground()
	gnd={}
	local top=96
	local btm=120
	
	pad={}
	pad.width=15
	pad.x=rnde(1,126-pad.width)
	pad.y=rnde(top,btm)
	pad.sprite=16
	
	--gen ground at pad
	for i=pad.x,pad.x+pad.width do
		gnd[i]=pad.y
	end
	
	--right of pad
	for i=pad.x+pad.width+1,127 do
		local h=rnde(gnd[i-1]-3,gnd[i-1]+3)
		gnd[i]=mid(top,h,btm)
	end
	
	--left of pad
	for i=pad.x-1,0,-1 do
		local h=rnde(gnd[i+1]-3,gnd[i+1]+3)
		gnd[i]=mid(top,h,btm)
	end
end

function draw_ground()
	for i=0,127 do
		line(i,gnd[i],i,127,5)
	end
	spr(pad.sprite,pad.x,pad.y,2,1)
end

__gfx__
000000000006600000066000000660000600a0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
000000000067c6000067c6000067c6000069a0070000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00700700306cc603306cc603806cc608300a97000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00077000606dd606606dd606606dd606609990090000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00077000666666666666666666666666680995960000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
007007006dd55dd66dd88dd66dd55dd6609888560000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
000000005050050590a99a0980500508988888990000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000500500a00aa00a00500500a99989900000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
800b55555555800b0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
6d6dddddddddd6d60000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
66600066660006660000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
__label__
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000050000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000700000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000006000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000050000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000007000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000600000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000060000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000007000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000006000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000060000000000000000000000000000000000000000000000000000000000000000000
00000000000070000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000005000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000060000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000006000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000700000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000007000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000007000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000050000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000005000000000000050000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000500000000000000000000000000000000000000000000000000000000
00000000000600000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000500000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000700000000000000000000000000000000000000000000000000000000000000000000000050000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000050000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000600000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000500000000000000000000000000000000000005000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000700000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000700000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000700000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000700000000000000000000000
00000000600000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000006
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000070000050000000005000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000070000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000060000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000006600000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000067c60000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000306cc60300000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000606dd60600000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000600000000000006666666600000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000006dd55dd600000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000005050050500000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000050050000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000070000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000050000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000050000060000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000555000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000005000000000000000555855b55555555855b05007000000000000000500000000000000000000000
000000000000000000000000000000000000000000000000050500000000000005556d6dddddddddd6d655500000000000000005500000000000000000005000
00000000000000000000000500000000000000000000000005055000000000005555666555666655566655550500000000000055500000000000000000005000
00000000005505000005055500000000000000000000000055555000000000005555555555555555555555555500000000000055550000000000000000005500
00005050005505000005055500500000000000000000000055555555000000005555555555555555555555555500000000000555555000005000000000055500
00005050555555000505555550500000000000000000000055555555000000555555555555555555555555555550000000005555555005055000000000055505
00055055555555505555555550550000000050050000000555555555000005555555555555555555555555555550000500055555555055555500000000055555
00055555555555505555555555555000550050050000000555555555500005555555555555555555555555555550000500055555555555555500000050555555
00055555555555505555555555555000550055550505000555555555550055555555555555555555555555555555005550055555555555555550000050555555
00555555555555555555555555555500555555555555005555555555550055555555555555555555555555555555005555555555555555555550000050555555
00555555555555555555555555555505555555555555505555555555550555555555555555555555555555555555005555555555555555555550005555555555
00555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555505555555555
05555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
05555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
55555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
55555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
55555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
55555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
55555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
55555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
55555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
55555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555

__sfx__
a60700000065500650006500065000600006000060000600006000060000600006000060000600006000060000600006000060000600006000060000600006000060000600006000060000600006000060000000
be10000015325133250e3250e3250e3250e3250e3250e3250e32511325153251a3252132524325263252632526325243251f3251f325213253532532325303252d325293251f3251f3251d3251d3251f3251f325
581000002655226522215522152215552155222655226522005022155224552245221d5021d502005020050200502005020050200502005020050200502005020050200502005020050200502005020050200502
120900003c563375633056329563225531d5531855313543115430e5430a543075430553303533025330253300523005230052300503005030250302503025030250300503000030000300003000030000300003
